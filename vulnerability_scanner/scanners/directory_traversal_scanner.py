from .payload_loader import load_payloads
from .request_engine import send_request
import logging

def scan_directory_traversal(url):
    payloads = load_payloads('payloads/directory_traversal/')
    for payload in payloads:
        response = send_request(url, {'file': payload})
        if response and "root:x:" in response.text:
            logging.info(f"Directory Traversal detected at {url} with payload {payload}")
            return True
    return False
