import logging

logging.basicConfig(filename='logs/scan_results.log', 
                    level=logging.INFO, 
                    format='%(asctime)s - %(levelname)s - %(message)s')
from .payload_loader import load_payloads
from .request_engine import send_request

def scan_sql_injection(url):
    payloads = load_payloads('payloads/sq.txt')
    for payload in payloads:
        print(payloads)
        response = send_request(url, {'input': payload})
        if response and "SQL syntax" in response.text:
            logging.info(f"SQL Injection detected at {url} with payload {payload}")
            return True
    return False
